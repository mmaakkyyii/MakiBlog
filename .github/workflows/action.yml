
name: deploy test
on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2
        with:
          submodules: true
      - name: Setup hugo
        run: |
            wget https://github.com/gohugoio/hugo/releases/download/v${HUGO_VERSION}/hugo_${HUGO_VERSION}_Linux-64bit.deb
            sudo dpkg -i hugo_${HUGO_VERSION}_Linux-64bit.deb
            hugo version
        env:
            HUGO_VERSION: '0.83.1'
      - name: Build hugo
        run: hugo
      - name: test env
        run: |
            echo ${VAL}
            ls
            sshpass -p "${SSH_PASS}" rsync -auvzP -e "ssh -p ${SSH_PORT}" ./public ${SSH_USER}@${SSH_IP}:
        env: 
            SSH_PASS: ${{secrets.SSH_PASS}}
            SSH_PORT: ${{secrets.SSH_PORT}}
            SSH_USER: ${{secrets.SSH_USER}}
            SSH_IP :  ${{secrets.SSH_IP}}
            VAL: ${{secrets.MAKI_SECRET_VAL}}
